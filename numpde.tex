% FWAM lecture. Func Approx & PDE. CCM beamer template.
%
% Build:
% pdflatex -shell-escape numpde; bibtex numpde; pdflatex numpde
%
% (here -shell-escape lets it call epstopdf to convert .eps to .stuff.pdf)

\documentclass[t]{beamer}
\usepackage[utf8]{inputenc}
\usepackage{epstopdf}  % handle EPS

\usepackage{multimedia,hyperref}   % embeds but needs external movie files

\usepackage{bm,tcolorbox}

% Alex's macros for beamer. Use macros to let you type less stuff
\newcommand{\ft}[1]{\frametitle{#1}}
% note: can't make macros for begin/end frame: http://tex.stackexchange.com/questions/326787/difficulty-in-creating-macro-newcommand-for-the-beginning-and-end-of-frames-i

% frame box on next slide
\newcommand<>{\tmpbox}[1]{
    \definecolor{colorbox}{RGB}{255,255,255}
    \only#2{\definecolor{colorbox}{RGB}{255,128,0}}
    \tcbox[left=0pt,right=0pt,top=0pt,bottom=0pt,colback=white,colframe=colorbox,nobeforeafter,tcbox raise base]{#1}
}
% https://tex.stackexchange.com/questions/186044/how-a-framebox-will-appear-around-the-text-on-a-click

\input{rgb}
\newcommand{\lb}[1]{{\color{darkblue}#1}}    % from prosper azure titles
\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\ben}{\begin{enumerate}}
\newcommand{\een}{\end{enumerate}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\bc}{\begin{center}}
\newcommand{\ec}{\end{center}}
\newcommand{\mbf}[1]{{\bm #1}}           % requires bm package
\newtheorem{thm}{Theorem}
\newcommand{\ig}[2]{\includegraphics[#1]{#2}}
\newcommand{\tbox}[1]{{\mbox{\tiny #1}}}
\newcommand{\cbox}[1]{{\mbox{\scriptsize #1}}}
%\newcommand{\who}[1]{{\tiny \textcolor{green}{(#1)}}}
\newcommand{\who}[1]{{\scriptsize \textcolor{darkgreen}{(#1)}}}
\newcommand{\whoc}[1]{{\scriptsize \textcolor{darkgreen}{#1}}} % use w/ \cite
\newcommand{\com}[1]{{\scriptsize \textcolor{purple}{#1}}}      % comment
\newcommand{\co}[1]{\mbox{\scriptsize \tt \textcolor{black} #1}}          % code
\newcommand{\vg}{\vspace{2ex}}
\newcommand{\sg}{\vspace{1ex}}
\newcommand{\hg}{\vspace{0.5ex}}
\newcommand{\gb}{\ensuremath{\textcolor{darkgreen}{\bullet\;}}\ }
\newcommand{\bmp}[1]{\begin{minipage}{#1}}
\newcommand{\bmpt}[1]{\begin{minipage}[t]{#1}}
\newcommand{\emp}{\end{minipage}}
\newcommand{\pig}[2]{\bmp{#1}\includegraphics[width=#1]{#2}\emp} % mp-fig, nogap
\newcommand{\pigm}[3]{\bmp{#1}\href{#3}{\includegraphics[width=#1]{#2}}\emp} % w/ movie
\newcommand{\ora}[1]{{\color{orange} #1}}
\newcommand{\gre}[1]{{\color{green} #1}}
\newcommand{\yel}[1]{{\color{yellow} #1}}
\newcommand{\red}[1]{{\color{red} #1}}
\newcommand{\sr}[1]{{\scriptsize #1}}
\newcommand{\vt}[2]{\biggl[\begin{matrix}#1\\#2\end{matrix}\biggr]} % 2-col-vec
\newcommand{\mt}[4]{\biggl[\begin{matrix}#1&#2\\#3&#4\end{matrix}\biggr]} %2x2

% macros for this work
\newcommand{\RR}{\mathbb{R}}
\newcommand{\sfrac}[2]{\mbox{\small $\frac{#1}{#2}$}}
\newcommand{\half}{\sfrac{1}{2}}
\newcommand{\bigO}{{\mathcal O}}
\newcommand{\eps}{\varepsilon}
\newcommand{\x}{\mbf{x}}
\newcommand{\y}{\mbf{y}}


\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\re}{Re}

\title{FWAM Session B: Function Approximation and Differential Equations}
\date{Wed, 10/30/19}
\author{\textbf{Alex Barnett}\inst{1} and \textbf{Keaton Burns}\inst{1,2}}
\institute{\inst{1} Center for Computational Mathematics, Flatiron Institute\\
  \inst{2} Center for Computational Mathematics, Flatiron Institute,
  and Department of Mathematics, MIT
}

\usetheme{CCM}
\setbeamertemplate{bibliography item}{\gb}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}


% ---------------------------------------------------
\begin{frame}\ft{LECTURE 1: interpolation, integration, spectral methods}

  
  \lb{Motivations}

  exact func.\ $f(x)$ described by $\infty$ number of points

  how handle approximately (but accurately) in computer, using least cost (bytes)? 
  \bi

\item
Interpolation: cheap but accurate look-up table for expensive $f(x)$

data fitting:
given non-noisy data $f(x_i)$ at some $x_i$, model $f(x)$ at other points $x$?

\quad\com{Contrast: fit noisy data = 
  learning (pdf for) params in model, via likelihood/prior}

\item (Numerical) integration:

  eg computing expectation values given a pdf 

\quad\com{Contrast: Monte Carlo (random, high-dim.) integration, Thurs am}
  
\item Differentiation:

  get gradient $\nabla f$ in order to optimize or
  
\item Spectral (often Fourier) methods:

If $f(x)$ is smooth, handle very accurately without much extra cost

\ei

Deterministic (non-random) methods.

Integr/diff crucial for numerical ODEs and PDEs \com{topic of LECTURE II}

\end{frame}


% ---------------------------------------------------
\begin{frame}\ft{Goals LECTURE I}

TODO
  
  teach range of practical methods focusing on 1D

  pointers to dimensions $d>1$

  concepts:

  convergence order

  spectral methods

  local vs global
  
  adaptivity

  rounding error

  interpolation = func.\ representation, key to all else

  
\end{frame}


% ---------------------------------------------------
\begin{noframe}\ft{Interpolation in 1D ($d=1$)}

\bmp{3in}
  Say $y_j = f(x_j)$ known at nodes $\{x_j\}$ \quad \com{$N$-pt ``grid''}

  exact data, not noisy
  
  want interpolant $\tilde f(x)$, s.t.\ $\tilde f(\x_j)=y_j$
  \emp
  \hfill
\pig{1.5in}{figs/fsamp}

\pause
\sg

\bmp{3.9in}
  hopeless w/o assumptions on $f$, eg smoothness, otherwise\dots

  \gb extra info helps, eg $f$ periodic, or $f(x) = \mbox{smooth}\cdot|x|^{-1/2}$
  \emp
  \hfill
\pig{.5in}{figs/fcrazy}

\pause
\vg

\bmp{3in}
\lb{Simplest}: use value at $x_j$ nearest to $x$

\hfill
\com{``snap to grid''}
%\com{$h=x_{j+1}-x_j$}

Error $\max_x|\tilde f(x)-f(x)| = \bigO(h)$ as $h\to 0$

\quad \com{holds if $f'$ bounded; can be nonsmooth but not crazy}
  
\emp
\hfill
\pig{1.4in}{figs/fsnap}

\sg

\gre{Recall %asymptotic
notation
  ``$\bigO(h)$'': exists $C,h_0>0$ s.t.\ error $\le Ch$ for all $h<h_0$}

\pause
\vg

\bmp{3in}
\lb{Piecewise linear}:

\hfill \com{``connect the dots''}

max error $ = \bigO(h^2)$ as $h\to 0$

\quad \com{needs $f''$ bounded, ie smoother than before}
  
\emp
\hfill
\pig{1.4in}{figs/flin}

\vg

Message: a higher order method is only higher order if $f$ smooth enough

\end{noframe}



% ---------------------------------------------------
\begin{noframe}\ft{Interlude: convergence rates}

  Should know or measure convergence rate of any method you use

\gb ``effort'' parameter $N$ \com{eg \# grid-points = $1/h^d$ where $h = $ grid spacing,  $d=$ dim}

We just saw algebraic conv.\ error $=\bigO(N^{-p})$, for order $p=1,2$

\pause

Is only one graph in numerical analysis: \framebox{``relative error vs effort''}

\sg

\pig{2.2in}{figs/convloglog}
\pause
\hfill
\pig{2.2in}{figs/convlinlog}
\pause

\sg

Note how spectral gets many digits for small $N$
\hfill \com{crucial for eg 3D prob.}
%Let's say a 3D prob.\ must have $N\le 300$: here spectral is 

\com{``spectral'' = ``superalgebraic'', $\bigO(N^{-k})$ for any $k$}

\gb how many digits to you want? \com{for 1-digit (10\% error), low order ok, easier to code}

\vg

\mbox{{\tt <rant>}
test your code w/ {\em known exact soln} to check error conv.
{\tt <\textbackslash rant>} }

\quad \com{What is the prefactor $C$ in error $\le Ch^k$ ? Has asymp.\ rate even kicked in yet? :)}

%You may not believe your model, but at least should trust its soln

\end{noframe}

% ---------------------------------------------------
\begin{frame}\ft{Higher-order interpolation for smooth $f$: the local idea}

  For any target $x$, use only set of nearest $p$ nodes:

  \bmp{2.9in}

  Exists unique degree-$(p-1)$ poly, $\sum_{k=0}^{p-1} c_k x^k$
  
  \quad which matches local data $(x_j,y_j)_{j=1}^p$
  
  \quad \com{generalizes piecewise lin. idea}

  \quad \com{do \red{not} eval poly outside its central region!}
  
  \emp
  \hfill
  \pig{1.6in}{figs/flocpoly}
  
  \gb error $\bigO(h^{k})$, ie high order, but $\tilde f$ {\em not} continuous ($\tilde f \notin C$) \com{small jumps}

  \quad \com{if must have cont, recommend splines, eg cubic $p=3$:
    $\tilde f\in C^2$, meaning $\tilde f''$ is cont.}
%   as target $x$ moves, ``jumps'' to another poly,
  
\pause

\vg

\lb{How to find the degree-$(k-1)$ poly?}

1) Crafty: solve square lin sys for coeffs\quad 
$\sum_{k<p} x_j^k c_k = y_j$ \hfill \com{ $j=1,\dots,p$}

\qquad ie $V\mbf{c} = \y$ \qquad \com{$V$=''Vandermonde'' matrix, is ill-cond.\ but works}

2) Traditional: barycentric formula
$\displaystyle \tilde f(x) = \frac{\sum_{j=1}^p \frac{y_j}{x-x_j}w_j}{\sum_{j=1}^p \frac{1}{x-x_j}w_j}$
\bmp{1in}

\hfill \com{$w_j = \frac{1}{\prod_{i\neq j}(x_j-x_i)}$}

\vg

\hfill\whoc{\cite[Ch.~5]{ATAP}}
\emp

\sg

Either way, $\tilde f(x) = \sum_{j=1}^p y_j \ell_j(x)$
where $\ell_j(x)$ is $\ell$th Lagrange basis func:

\qquad \pig{2in}{figs/lag}


\end{frame}

% ---------------------------------------------------
\begin{noframe}\ft{Global polynomial (Lagrange) interpolation?}

  Want increase order $p$. Use {\em all} data, get single $\tilde f(x)$, so $p=N$?
  \hfill\com{``global''}

  $p=N=32$, smooth (analytic) $f(x) = \frac{1}{1+9x^2}$ on $[-1,1]$ : \hfill\who{Runge 1901}
  
  \pig{2.2in}{figs/demopoly1}
  \hfill
  \uncover<3->{
  \pig{2.2in}{figs/demopoly2}
  }
  
\pause
  \gb warning: \red{unif.\ grid, global interp.\ fails} \; \com{$\rightarrow$ only use locally in central region}
%  interval $[a,b]$

  \pause
  \bmp{3in}
  But exists good choice of nodes\ldots

\hg
  
  ``Chebychev'': \com{means non-unif.\ grid density $\sim \frac{1}{\sqrt{1-x^2}}$}

  \gb our first spectral method % basis of higher-dim $d>1$ methods\ldots

\quad   max err $=\bigO(\rho^{-N})$
\hfill \com{exponential conv!}
  
\quad \com{  $\rho>1$ ``radius'' of largest
  ellipse in which $f$ analytic}
  
\emp
\hfill
  \pig{1.6in}{figs/bern}

% * give the rate rho = 1.39.. ?  x=1i/3; rho=abs(x + sqrt(x^2-1)), rho^-32
  
% * Lebesgue const?

  
  
\end{noframe}

\begin{noframe}\ft{Node choice and adaptivity}

Recap poly approx.\ $f(x)$ on $[a,b]$: are good \& bad node sets $\{x_j\}_{j=1}^N$

\sg

  \lb{Question}: Do you get to {\em choose} the set of nodes at which $f$ known?

\sg
  
  \gb No: data fitting applications \com{(or noisy variants: kriging, Gaussian processes, etc)}

  \qquad \com{use local poly (central region only!), or something stable (splines)}
  
  \gb Yes: almost all else, interp., quadrature, PDE solvers
  \hfill \com{so pick good nodes!}

  \pause
  \vg
  
\lb{Adaptivity idea}
\hfill \com{global is \red{inefficient} if $f$ smooth in most places, structured in a few}

\pause
\sg

 \only<3>{ \pig{3.2in}{figs/adap1} }
 \pause
 \pig{3.2in}{figs/adap2}
 \hfill
 \bmp{1.2in}
% Given tolerance $\eps$ (eg $10^{-12}$)

 automatically split
 
(recursively) panels

 until max err $\le\epsilon$

\sg
 
 \com{via tests for local error}
 
 \emp

\vg
 
1D adaptive interpolator codes to try:

 \gb {\tt github/dbstein/function\_generator}
 \; \com{py+numba, fast} \hfill \who{Stein '19}

 \gb {\tt chebfun} for MATLAB\;
\com{big-$p$ Cheb.\ grids can exploit FFTs!}
\hfill  \who{Trefethen et al.}

\sg
 
App.:  replace nasty expensive $f(x)$ by cheap one! \hfill \com{optimal ``look-up table''}


\end{noframe}
    
% ---------------------------------------------------
\begin{frame}\ft{Interpolation of periodic functions}

  \com{Just did $f$ on intervals $[a,b]$. \;
    Interpolation (\& integration, etc.) of {\em periodic} $f$ not same!}

\hg

  Periodic: 
  $f(x+2\pi)=f(x)$ for all $x$, \quad $f(x) = \sum_{n\in\mathbb{Z}} \hat f_k e^{ikx}$
  \hfill \com{Fourier series}

\pause
  
  instead of poly's, use \ora{truncated} series \;
  $\tilde f(x) = \sum_{|k|<N/2} c_k e^{ikx}$ \hfill\com{``trig.\ poly''}

  \sg

  What's best you can do? if $\hat f_n$ decays rapidly, 

  

How get $c_n$?  unif.\ grid now good! Use FFT of vals $f(2\pi j/N)$, $j=1,\dots,N$

$c_n = $
  


  
exp conv if $f$ analytic in strip.



what if $f$ not as smooth as this?

relapse to conv.\ order given by smoothness of $f$

why? $\hat{f}_n$ decay



Messages: spectral conv usually requires understanding $f$ off the real axis!

smooth = rapid Fourier series decay = rapid conv


\end{frame}



% ---------------------------------------------------
\begin{frame}\ft{Interpolation in $d>1$}


  can you choose the points?

  data fit: often no
  
  PDE solve: usually yes - product grids, piecewise (FEM), etc
  
    \bmp{2.1in}
  in $d>1$ getting $f(\x)$ from scattered data $\{\x_i\}$ is hard

  \com{Eg google terrain: $f(\x)$ rough $\rightarrow$ v low ord}
% Bavarian pre-alps
  
  \emp
  \hfill
  \pig{2.3in}{figs/gterrain_lab}

  unless you know $f$ smooth, eg fit local multivariate polynomial

  kriging

  
 \end{frame}

% ---------------------------------------------------
\begin{frame}\ft{Numerical integration}

Usually the user gets to choose the nodes $x_j$
  
  Once have interpolant $\tilde f$ from data $f(x_j)$, can {\em
    integrate it exactly}

  \com{``intepolatory quadrature''}

  Eg: piecewise linear gives composite trap rule  $\bigO(N^{-2})$

  periodic spectral gives periodic trap rule $\bigO(c^{-N})$ if analytic

  
  
  
\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}


% ---------------------------------------------------
\begin{frame}\ft{}
TO DO


extrapolation

  Rounding error  \cite[Ch.~5--6]{GCbook}
  
\end{frame}





% ---------------------------------------------------
\begin{frame}\ft{LECTURE II: numerical differential equations}

  For now we start with ``elliptic'': time-independent problems

  Motivations
  
  eg steady-state (equilibrium) diffusion of a chemical

  eg what electric potential caused by bunch of charges surrounded by H$_2$O ?
  (protein electrostatics)

  Find $u$ solving $\Delta u = f$,  \com{$f = $ volume source term}

  \hfill \com{$\Delta$ means Laplacian $\partial^2/\partial x^2 + \partial^2/\partial y^2 + \dots$. \quad $\Delta u$ is curvature of $u$}

  plus some BCs on $u$

  eg viscous fluid flow: $\mbf{u}$ is velocity field, sat Stokes eqns
  
  eg what is ground state of quantum system, solving $\Delta u = Eu$


  
  Mike will in next talk overview this and 2 other flavors of PDE

  
  
\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{}

\end{frame}

% ---------------------------------------------------
\begin{frame}\ft{References}

\bibliographystyle{amsalpha}  % abbrv
\bibliography{numpde}
  
\end{frame}



\end{document}
