% edited from FlatironBeamerTemplate.sty, A H Barnett 11/2/18
% couple tweaks, Feb 2019, AHB.
\mode<presentation>

% Requirement
\RequirePackage{tikz}
\RequirePackage{textcomp}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{blocks}[rounded][shadow=true]  

% define colors
\definecolor{myblue}{HTML}{537EBA}
\definecolor{CCMorange}{HTML}{F6862D}
\definecolor{mygray}{HTML}{8F8F8F}
\definecolor{mydark}{HTML}{263176}

% Settings
\setbeamercolor{title page header}{fg=CCMorange}
\setbeamercolor{author}{fg=mydark}  % was mygray
\setbeamercolor{date}{fg=mygray}
\setbeamercolor{institute}{fg=mygray,use=mygray}
\setbeamercolor{item}{fg=CCMorange}
\setbeamercolor{frametitle}{fg=CCMorange}
%\setbeamercolor{block title}{fg=lightgray,bg=CCMorange} % ahb: poor contrast!
\setbeamercolor{block title}{fg=black,bg=CCMorange}   % clearer theorem title
\setbeamercolor{block body}{use=structure,fg=black,bg=white}

% spacing
\def\beamer@andinst{\\[0.0em]}

\def\barheight{0.10}   % ahb: vary bottom orange bar. default: 0.5 (inches?)

% font sizes
\setbeamerfont{author}{size=\small}
\setbeamerfont{date}{size=\small}
\setbeamerfont{institute}{size=\footnotesize}
\setbeamerfont{title}{size=\Large}
\setbeamerfont{frametitle}{size=\Large}

% itemize
\setbeamertemplate{items}[circle]

% margins
\setbeamersize{text margin left=0.2in, text margin right=0.2in}
\setbeamertemplate{footline}{\vspace{0.6cm}}

% Background
\setbeamertemplate{background}{
  \begin{tikzpicture}
  \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
  \node[inner sep=0pt] (flatiron_logo) at (11.4,9)
    {\includegraphics[width=0.2\textwidth]{CCM_logo.pdf}};
  \fill[color=CCMorange] (0,0) rectangle(\the\paperwidth,\barheight);
  \ifnum\thepage>1\relax%
    \fill[white,opacity=1] (0,0) rectangle(\the\paperwidth,\the\paperheight);
    \fill[color=CCMorange] (0,0) rectangle(\the\paperwidth,\barheight);
    \node[inner sep=0pt] (flatiron_logo) at (11.4,0.4+\barheight)
      {\includegraphics[width=0.2\textwidth]{CCM_logo.pdf}};
    \fi
  \end{tikzpicture}
}

% Background for slides with no Flatiron logo
\newenvironment{noframe}{
  \setbeamertemplate{background}{
    \begin{tikzpicture}
      \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
      \fill[white,opacity=1] (0,0) rectangle(\the\paperwidth,\the\paperheight);
      \fill[color=CCMorange] (0,0) rectangle(\the\paperwidth,\barheight);
    \end{tikzpicture}
  }
  \begin{frame}
}
{
  \end{frame}
}

% Title page
\defbeamertemplate*{title page}{CCM}[1][]
{ 
  \vskip2cm
    \begin{beamercolorbox}[wd=12cm,leftskip=0.2cm,#1]{title page header}
      \usebeamerfont{title}\inserttitle\par
    \end{beamercolorbox}
  \vskip0.75cm
    \begin{beamercolorbox}[wd=12cm,leftskip=0.2cm,#1]{author}
      \usebeamerfont{author}\insertauthor
    \end{beamercolorbox}
  \vskip0.3cm
    \begin{beamercolorbox}[wd=12cm,leftskip=0.2cm,#1]{date}
      \usebeamerfont{date}\insertdate
    \end{beamercolorbox}
  \vskip0.3cm
    \begin{beamercolorbox}[wd=12cm,leftskip=0.2cm,#1]{intstitute}
      {\color{mygray}
      \usebeamerfont{institute}\insertinstitute
      }
    \end{beamercolorbox}
  \vfill
}

% Frame title
\defbeamertemplate*{frametitle}{CCM}[1][]
{
  \vskip-1em
  \begin{beamercolorbox}[wd=\paperwidth,ht=1.2cm]{frametitle} 
  \begin{tikzpicture}
  \useasboundingbox[fill=white](0,0) rectangle(\the\paperwidth,1.2);
    \node[anchor=west] at (0.2,0.0){\insertframetitle};
  \end{tikzpicture}
  \end{beamercolorbox}
}

\mode<all>
